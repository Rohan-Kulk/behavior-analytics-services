
1. Create the .
```execute
cat <<'EOF'>full-deployment.yaml
apiVersion: bas.ibm.com/v1
kind: FullDeployment
metadata:
  name: fulldeployment-demo
spec:
  postgres:
    storage_class: ibmc-block-bronze
    storage_size: 10G
  ibmproxyurl: "https://iaps.ibm.com"
  prometheus_scheduler_frequency: "*/10 * * * *"
  event_scheduler_frequency: "*/10 * * * *"
  airgapped:
    enabled: false
    persistent_storage:
      storage_class: ibmc-file-bronze-gid
      storage_size: 10G
      backup_retention_period: 7
      backup_deletion_frequency: "@daily"
  image_pull_secret: bas-images-pull-secret
  segment_key: set_segment_key_value
  kafka:
    storage_class: ibmc-block-bronze
    storage_size: 5G
EOF
```

2. Update the deployment yaml as per the specification below-
         Spec                                                 |            Details
    ----------------------------------------------------------|-----------------------------
    ibmproxyurl                                               | URL of IBM Proxy Service
    postgres.storage_class                                    | Storage class of type ReadWriteOnce 
    postgres.size                                             | Size (in Mi or G) of the storage to be attached to the Database
    airgapped.enabled                                         | true/false if airgapped setup is to be enabled. *Requires additional storage
    airgapped.persistent\_storage.storage\_size               | Size (in Mi or G) of the storage to be attached for saving airgapped files
    airgapped.persistent\_storage.storage\_class              | Storage class to be used for the persistent storage
    airgapped.persistent\_storage.backup\_retention\_period   | Number of days to keep the backup files in the storage
    airgapped.persistent\_storage.backup\_deletion\_frequency | Frequency of Cronjob to execute which will delete files from the storage
    event\_scheduler\_frequency                               | Scheduler frequency in Cronjob format to forward events to proxy ( https://en.wikipedia.org/wiki/Cron )
    prometheus\_scheduler\_frequency                          | Prometheus Scheduler Frequency in Cronjob format to pull metrics from Prometheus
    image\_pull\_secret                                       | Secret to pull container images from registry
    segment\_key                                              | Segment key to be used to send events to Segment

    3. Execute command to install the Deployment:
    ```execute
    oc create -f full-deployment.yaml
    ```
   
    4. The deployment takes ~20 mins to complete. The status of the deployment can be checked from the status.phase field of the deployment instance  The state will be "Ready" when the installation is complete.
     oc get FullDeployment fulldeployment -o yaml | grep "phase"

    Alternately, check the status of all the pods. They should be either in Running or Completed state

     oc get pods

    5. Generate an API Key to use it for authentication (of Onboarding and Metrics APIs). UPdate he metadata.name
    ```execute
    cat <<'EOF'>api-key.yaml
    apiVersion: bas.ibm.com/v1
    kind: GenerateKey
    metadata:
      name: bas-api-key
    spec:
      image_pull_secret: bas-images-pull-secret
    EOF
    ```

    6. Execute command to create the API Key:
    ```execute
    oc create -f api-key.yaml
    ```

   7. To get the URLs to the Behavior Analytics Services Endpoint URL and  Grafana dashboard URL, execute the below commands 
```execute
bas_endpoint_url=https://$(oc get routes bas-endpoint -n bas-demo |awk 'NR==2 {print $2}')
echo $bas_endpoint_url
```

```execute
grafana_dashboard_url=https://$(oc get routes grafana-route -n bas-demo |awk 'NR==2 {print $2}')
echo $grafana_dashboard_url
```